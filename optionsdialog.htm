<!DOCTYPE HTML>
<html name="body">
  <head>
    <script src="jquery.min.js"></script>
    <script type="text/javascript">
     var WizExplorerApp = window.external;
     var objApp = WizExplorerApp;
     var objWindow = objApp.Window;

     function getParams(){
       return objWindow.GetHtmlDialogParam(WizChromeBrowser);
     }
     function save(){
       var retarray = new Array();
       retarray[0] = document.getElementById("otw_tags").value;
       retarray[1] = getValue("otw_attach");
       retarray[2] = getValue("otw_encode");
       retarray[3] = getValue("otw_script");
       retarray[4] = getValue("otw_tagopt");
       retarray[5] = getValue("otw_html");
       retarray[6] = getValue("otw_date");
       objWindow.CloseHtmlDialog(WizChromeBrowser, retarray);
     }
     function getValue(eleid){
       var ele = document.getElementById(eleid);
       return ele.options[ele.selectedIndex].value;
     }
     function cancell(){
       objWindow.CloseHtmlDialog(WizChromeBrowser, null);
     }
     $(document).keydown(function(e) {
       // ESCAPE key pressed
       if (e.keyCode === 27) {
         // alert(document.activeElement.tagName);
         cancell();
       }
     });
     $(document).keydown(function(e) {
       // ENTER key pressed if focus is on DefaultTag input box or no focus, which means focus is on the body
       if((e.keyCode === 13) && ((document.activeElement.name === "DefaultTag") || (document.activeElement.tagName === "BODY"))){
         save();
       }
     });
    </script>
    <style type="text/css">
     .buttons{
       height:30px;
       width:65px;
     }
    </style>
  </head>
  <body name="body" value="bodys">
    <form name="OptionsForm">
      <p>
        Org2Wiz 默认标签(T)：<input type="text" class="edited" name="DefaultTag" id="otw_tags" defaultvalue="" accesskey="T" />
      </p>
      <p>
        Org2Wiz 标签选项(Q)：<select class="edited" name="TagOption" id="otw_tagopt" accesskey="Q">
        <option value="nop" select="selected">无操作</option>
        <option value="adddefault">添加默认标签</option>
        <option value="updatefromorg">从org文件中更新标签</option>
        </select>
      </p>
      <p>
        Org2Wiz 附件选项(A)：<select class="edited" name="AttachmentsOption" id="otw_attach" accesskey="A">
        <option value="nodisplay" select="selected">不显示 AddAttach</option>
        <option value="addtex">显示 AddAttach，添加 .tex</option>
        <option value="addpdf">显示 AddAttach，添加 .pdf</option>
        <option value="addtexpdf">显示 AddAttach，添加 .tex 和 .pdf</option>
        </select>
      </p>
      <p>
        Org2Wiz 文件编码(E)：<select class="edited" name="OrgEncodingOption" id="otw_encode" accesskey="E">
        <option value="utf8" select="selected">UTF-8</option>
        <option value="utf8bom">UTF-8-BOM</option>
        <option value="unicode">Unicode</option>
        <option value="gbk">GBK</option>
        </select>
      </p>
      <p>
        Org2Wiz 脚本选项(X)：<select class="edited" name="ScriptOption" id="otw_script" accesskey="X">
        <option value="yes">保留</option>
        <option value="no" select="selected">去除</option>
        </select>
      </p>
      <p>
        Org2Wiz Html文件(H)：<select class="edited" name="HtmlOption" id="otw_html" accesskey="H">
        <option value="yes">保留</option>
        <option value="no" select="selected">去除</option>
        </select>
      </p>
      <p>
        Org2Wiz 复制时间(C)：<select class="edited" name="CopyDate" id="otw_date" accesskey="C">
        <option value="nop" select="selected">无操作</option>
        <option value="copyall">首次复制更新时间，后续复制更新时间</option>
        <option value="establish">首次复制创建时间</option>
        <option value="update">复制更新时间</option>
        </select>
      </p>
      <div style="text-align: center">
        <button id="saveform" class="buttons" type="submit" value="save" onclick="save()" accesskey="S">保存(S)</button>
        &nbsp;
        <button id="cancellform" class="buttons" type="submit" value="cancell" onclick="cancell()" accesskey="Z">取消(Z)</button>
        &nbsp;
        <button id="resetform" class="buttons" type="reset" value="reset" accesskey="R">重置(R)</button>
      </div>
    </form>
    <script type="text/javascript">
     document.getElementById("otw_tags").defaultValue = getParams()[0];
     document.getElementById("otw_attach").value = getParams()[1];
     document.getElementById("otw_encode").value = getParams()[2];
     document.getElementById("otw_script").value = getParams()[3];
     document.getElementById("otw_tagopt").value = getParams()[4];
     document.getElementById("otw_html").value = getParams()[5];
     document.getElementById("otw_date").value = getParams()[6];
    </script>
  </body>
</html>
